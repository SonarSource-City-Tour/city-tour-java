package foo.security.injection;

import java.sql.Connection;
import java.sql.SQLException;
import java.sql.Statement;

public class SQLInjectionVulnerability {
  final static String SELECT_SQL = "select FNAME, LNAME, SSN from USERS where UNAME = ";

  public SQLInjectionVulnerability(String uname) throws SQLException {
    Connection con = DatabaseHelper.getJDBCConnection();
    Statement stmt = con.createStatement();

    if (uname == null) {
      uname = "default";
    }

    stmt.execute(SELECT_SQL + uname); // Noncompliant

    stmt.execute("select FNAME, LNAME, SSN from USERS where UNAME = default"); // Safe
  }
}
